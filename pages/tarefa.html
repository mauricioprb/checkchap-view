<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="tituloPagina">CheckChap: Tarefa Criada com Sucesso!</title>
</head>

<body>
  <div>
    <h2 id="tituloLista" onclick="handleTituloClique()"></h2>
    <div>
      <input type="text" id="inputTitulo" placeholder="Definir tÃ­tulo" onblur="handleTituloSair()"
        onkeydown="handleTituloPressionarTecla()" />
    </div>
    <ul id="listaItens">
    </ul>
    <div>
      <input id="inputItem" type="text" onkeydown="handleAdicionarItem(event)" placeholder="Adicionar item">
    </div>
  </div>
  <div>
    <input type="text" id="inputUrl" readonly>
    <button onclick="copiarUrl()">Copiar URL</button>
  </div>
  <script>
    let editandoTitulo = false;
    let titulo = '';
    let itens = [];
    let novoItem = '';

    let elementoTituloPagina = document.getElementById('tituloPagina');
    let elementoTituloLista = document.getElementById('tituloLista');
    let elementoInputTitulo = document.getElementById('inputTitulo');
    let elementoInputUrl = document.getElementById('inputUrl');

    const handleTituloClique = () => {
      editandoTitulo = true;
      elementoTituloLista.style.display = 'none';
      elementoInputTitulo.style.display = 'block';
      elementoInputTitulo.value = titulo;
      elementoInputTitulo.focus();
    };

    const handleTituloSair = () => {
      editandoTitulo = false;
      titulo = elementoInputTitulo.value;
      elementoTituloPagina.innerHTML = titulo || 'Tarefa';
      elementoTituloLista.innerHTML = titulo || 'Tarefa';
      elementoTituloLista.style.display = 'block';
      elementoInputTitulo.style.display = 'none';
    };

    const handleTituloPressionarTecla = (event) => {
      if (event.key === 'Enter') {
        handleTituloSair();
      }
    };

    const handleAdicionarItem = (event) => {
      if (event.key === 'Enter') {
        let itemInput = document.getElementById('inputItem');
        let textoItem = itemInput.value;
        if (textoItem) {
          let novoItem = { id: Date.now(), texto: textoItem };
          itens.push(novoItem);
          renderizarItens();
          itemInput.value = '';
        }
      }
    };

    const handleExcluirItem = (itemId) => {
      itens = itens.filter((item) => item.id !== itemId);
      renderizarItens();
    };

    const renderizarItens = () => {
      let listaItens = document.getElementById('listaItens');
      listaItens.innerHTML = '';
      itens.forEach((item) => {
        let li = document.createElement('li');
        li.setAttribute('id', 'item-' + item.id);

        let checkbox = document.createElement('input');
        checkbox.setAttribute('type', 'checkbox');

        let span = document.createElement('span');
        span.innerHTML = item.texto;

        let deleteButton = document.createElement('button');
        deleteButton.innerHTML = 'Excluir';
        deleteButton.setAttribute('onclick', `handleExcluirItem(${item.id})`);

        li.appendChild(checkbox);
        li.appendChild(span);
        li.appendChild(deleteButton);

        listaItens.appendChild(li);
      });
    };

    const copiarUrl = () => {
      elementoInputUrl.select();
      elementoInputUrl.setSelectionRange(0, 99999);
      document.execCommand("copy");
    };

    elementoInputUrl.value = window.location.href;
  </script>
</body>

</html>